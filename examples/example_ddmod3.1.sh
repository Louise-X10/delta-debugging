#!/bin/bash

arvo
CRASH_INPUT=/src/clusterfuzz-testcase-minimized-server-6088352019251200
SEED=1037d8ef263682ea727da03710954173df7212ac
TARGET=server
VALID_INPUT=/src/boringssl/fuzz/${TARGET}_corpus/$SEED

git clone https://github.com/Louise-X10/delta-debugging.git
cd delta-debugging/examples
python3 example_ddmod3.py $CRASH_INPUT $VALID_INPUT $TARGET

# Crashing input:
# b'\x00\x00\x16\x03 \x00C\x01\x00\x00:                           \xff\xff\xff\xff\xff\xff \x05     \x00\x02\x00\x02\x03  \x00\x00\x08\x00\x10\x00\x04\x00\x02\x01\xff\xff\xff\xff\xff\xff'

# Minimal crashing input:
# b'\x00\x00\x16\x03 \x00C\x01\x00\x00:                           \xff\xff\xff\xff\xff\xff \x05     \x00\x02\x00\x02\x03  \x00\x00\x08\x00\x10\x00\x04\x00\x02\x01\xff\xff\xff\xff\xff\xff'

# Valid input:
# b'\x00\x00\x16\x03\x01\x01\x1e\x01\x00\x01\x1a\x03\x02$\x03\xdf\x16]\x15:~A\x94\xb6L\x160\x7fu\xc17\xb5\xb7^K\xc86\xbfp\xe2\x88Np\x02\x1d\x10\xa9\x87\xc6X;X\xe5\xceV4In\x11\xf8=-\x00\x02\x00\x02\x01\x00\x00\xdf\x00\x00\x00\t\x00\x07\x00\x00\x04test\x00\x05\x00\x05\x01\x00\x00\x00\x00\x00\n\x00\n\x00\x08\x00\x1d\x00\x17\x00\x18\x00\x19\x00\x0b\x00\x02\x01\x00\x00-\x00\x02\x01\x01\x00#\x00\x9e\xeap\xfd\xd1\x134\xd6\xc5-mA\x9e\xcb\xa0\x86\x9b?\xa9\xfas8~\x13PX\xf69\xf7\xd7\x1e2Q0\\\x02\x01\x01\x02\x02\x03\x02\x04\x02\x00\x02\x04\x00\x040\xa6\xfc\xa3\x05w\xc2\x9e\x0b\xf8IM\x94\x9e\x9e`/6\xfc\xb7Q\xe7l7B\xa6-!,\x88P\x1f\x07C1\xb1c\\\x16A!\xd7\xec{G\x03i:\xea\xa1\x04\x02\x02\x04\xd2\xa2\x04\x02\x02\x1c \xa4\x02\x04\x00\xa6\x06\x04\x04test\xb1\x03\x01\x01\xff\xae\x81\x8c\x8e\xdd\x02\xc5\xac\xcbC\x1a6\x82\x87\xf1\xef\xf9G\xc0\xfc\xe7h\x96Q\xb9\xce\xbds\xe6\xc8gE\xff\x01\x00\x01\x00\x00\x17\x00\x00\x00\x12\x00\x00\x14\x03\x02\x00\x01\x01\x16\x03\x02\x00\x10\x14\x00\x00\x0c\x93\xbbm\xc5h\x01,\x97\x99\x97.\x13\x17\x03\x02\x00 BBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBB\x15\x03\x02\x00\x02\x01\x00'

# Maximal crashing input:
# b'\x00\x00\x16\x03 \x00C\x01\x00\x00: B\x15                        \xff\xff\xff\xff\xff\xff \x05     \x00\x02\x00\x02\x03  \x00\x00\x08\x00\x10\x00\x04\x00\x02\x01\xff\xff\xff\xff\xff\xff'